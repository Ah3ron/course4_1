# ПОЯСНИТЕЛЬНАЯ ЗАПИСКА

## К курсовому проекту по дисциплине «Распределенные информационные системы»

### На тему: «Разработка распределенной системы оценки кредитных рисков на основе статистических моделей»

---

**РЕФЕРАТ**

Пояснительная записка содержит 45 страниц, 3 рисунка, 8 таблиц, 15 источников, 2 приложения.

КЛЮЧЕВЫЕ СЛОВА: РАСПРЕДЕЛЕННАЯ ИНФОРМАЦИОННАЯ СИСТЕМА, КЛИЕНТ-СЕРВЕРНАЯ АРХИТЕКТУРА, ОЦЕНКА КРЕДИТНЫХ РИСКОВ, МОДЕЛЬ АЛЬТМАНА, МОДЕЛЬ ТАФФЛЕРА, БАЗА ДАННЫХ, REST API, ВЕБ-ПРИЛОЖЕНИЕ.

Объектом исследования является процесс оценки кредитных рисков компаний и физических лиц в финансовых учреждениях.

Предметом исследования является разработка распределенной информационной системы для автоматизации процесса оценки кредитных рисков.

Цель курсового проекта – разработка распределенной информационной системы для оценки кредитных рисков с использованием статистических моделей Альтмана и Таффлера.

В результате выполнения курсового проекта разработана распределенная информационная система, реализующая клиент-серверную архитектуру с веб-интерфейсом, обеспечивающая оценку кредитных рисков на основе финансовых показателей, хранение и обработку данных в реляционной базе данных PostgreSQL, предоставление аналитической информации через REST API и современный пользовательский интерфейс на базе фреймворка Svelte.

---

## ВВЕДЕНИЕ

В современном мире финансовые учреждения сталкиваются с необходимостью эффективной оценки кредитных рисков при принятии решений о предоставлении кредитов. Традиционные методы оценки, основанные на субъективном анализе, не всегда обеспечивают достаточную точность и объективность. В связи с этим актуальной задачей является разработка автоматизированных систем, использующих проверенные статистические модели для оценки кредитоспособности заемщиков.

Распределенные информационные системы играют ключевую роль в современной информатике, обеспечивая возможность обработки данных на различных узлах сети, повышая отказоустойчивость и масштабируемость решений. Применение клиент-серверной архитектуры позволяет разделить функциональность между клиентским приложением и серверной частью, что обеспечивает централизованное управление данными и бизнес-логикой.

Объектом исследования является процесс оценки кредитных рисков компаний и физических лиц в финансовых учреждениях.

Предметом исследования является разработка распределенной информационной системы для автоматизации процесса оценки кредитных рисков с использованием статистических моделей.

Цель курсового проекта заключается в разработке распределенной информационной системы для оценки кредитных рисков, обеспечивающей автоматизированный расчет показателей на основе моделей Альтмана и Таффлера, хранение и обработку данных в реляционной базе данных, предоставление аналитической информации пользователям через веб-интерфейс.

Для достижения поставленной цели необходимо решить следующие задачи: провести анализ предметной области и определить требования к разрабатываемой системе, спроектировать архитектуру распределенной информационной системы с использованием клиент-серверной модели и REST API, разработать структуру базы данных для хранения информации об оценках кредитных рисков, реализовать серверную часть приложения на базе фреймворка FastAPI с асинхронной обработкой запросов, реализовать клиентскую часть приложения с веб-интерфейсом на базе фреймворка Svelte, реализовать алгоритмы расчета кредитных рисков на основе моделей Альтмана и Таффлера, а также скоринговую модель для физических лиц, обеспечить контейнеризацию системы с использованием Docker и Docker Compose, реализовать функциональность сохранения и загрузки данных, просмотра статистики и истории оценок, провести тестирование разработанной системы.

Ожидаемым результатом курсового проекта является функционирующая распределенная информационная система, обеспечивающая оценку кредитных рисков, хранение данных в базе данных PostgreSQL, предоставление аналитической информации через REST API и удобный веб-интерфейс.

Структура курсового проекта включает введение, четыре основных раздела, заключение, список использованных источников и приложения. В первом разделе приводится описание предметной области, постановка задачи и анализ требований. Во втором разделе описывается проектирование системы, включая логическую и физическую структуру, моделирование взаимодействия компонентов, проектирование моделей данных и интерфейса. В третьем разделе описывается реализация программного модуля, включая реализацию серверной и клиентской частей, финансовых моделей и требований. В четвертом разделе описывается тестирование программного модуля.

---

## 1 ОПИСАНИЕ ПРЕДМЕТНОЙ ОБЛАСТИ

### 1.1 Постановка задачи

Разрабатываемая система представляет собой распределенную информационную систему для оценки кредитных рисков компаний и физических лиц. Система предназначена для автоматизации процесса анализа финансовых показателей и расчета вероятности банкротства или дефолта заемщика на основе проверенных статистических моделей.

Назначение разрабатываемой программы заключается в предоставлении финансовым учреждениям инструмента для объективной оценки кредитных рисков, что позволяет принимать обоснованные решения о предоставлении кредитов, оптимизировать кредитный портфель и минимизировать финансовые потери.

Входными данными для программы являются следующие. Для оценки кредитного риска компании требуются: наименование компании, дата оценки, текущие активы, текущие обязательства, заемный капитал, пассивы (общие обязательства), прибыль от продаж, краткосрочные обязательства, долгосрочные обязательства, общие активы и выручка от продаж. Для оценки кредитного риска физического лица необходимы: фамилия, имя, отчество, дата оценки, ежемесячный доход, ежемесячные расходы, сумма кредита, кредитная история (балл от 0 до 1), наличие залога (да/нет), стаж работы и возраст.

Выходными данными программы являются следующие результаты. Для оценки кредитного риска компании система выдает: Z-score по модели Альтмана, уровень риска по модели Альтмана (низкий, средний, высокий), рекомендацию по модели Альтмана, T-score по модели Таффлера, уровень риска по модели Таффлера (низкий, средний, высокий), рекомендацию по модели Таффлера, комбинированный уровень риска и комбинированную рекомендацию. Для оценки кредитного риска физического лица формируются: кредитный скоринг (балл от 300 до 850), уровень риска (низкий, средний, высокий) и рекомендация. Кроме того, система предоставляет статистическую информацию, включающую список всех проведенных оценок, историю оценок для конкретной компании или физического лица, а также возможность фильтрации по датам и наименованиям.

Требования к функциональным характеристикам программы:

Разрабатываемая программа должна обеспечивать возможность выполнения следующих функций: ввода исходных данных для оценки кредитного риска компании через веб-интерфейс, ввода исходных данных для оценки кредитного риска физического лица через веб-интерфейс, расчета показателей кредитного риска на основе модели Альтмана, расчета показателей кредитного риска на основе модели Таффлера, расчета комбинированной оценки риска, расчета кредитного скоринга для физических лиц, сохранения результатов оценок в базе данных PostgreSQL, просмотра списка всех проведенных оценок, фильтрации оценок по различным критериям (дата, наименование), просмотра истории оценок для конкретной компании или физического лица, удаления записей из базы данных и получения статистической информации через REST API.

Требования к организации ввода входных данных:

Ввод данных осуществляется через веб-интерфейс клиентского приложения. Предусмотрена проверка на принадлежность входных данных допустимым диапазонам, валидация формата вводимых данных на клиентской и серверной сторонах, отображение сообщений об ошибках при некорректном вводе и возможность повторного ввода при ошибочных данных. Числовые значения должны быть положительными, даты должны быть в допустимом диапазоне, а строковые значения не должны быть пустыми.

Требования к организации вывода выходных данных:

Результаты расчетов отображаются на экране в веб-интерфейсе и сохраняются в базе данных PostgreSQL. Статистическая информация отображается в виде таблиц и графиков. Предусмотрена возможность просмотра истории оценок с визуализацией динамики показателей.

Требования к интерфейсу пользователя:

Разрабатываемая программа должна иметь веб-интерфейс пользователя, обеспечивающий интуитивно понятную навигацию, удобный ввод данных через формы, наглядное отображение результатов расчетов с цветовой индикацией уровня риска, возможность просмотра статистики и истории оценок, отображение графиков и диаграмм для визуализации данных, обработку ошибок с понятными сообщениями пользователю и адаптивный дизайн для работы на различных устройствах.

Требования к обработке ошибок:

При выполнении программы необходимо предусмотреть обработку следующих ошибок: неправильный формат исходных данных (нечисловые значения в числовых полях, некорректные даты), выход значений за допустимые диапазоны (отрицательные числа, нулевые значения где недопустимы), ошибки подключения к базе данных, ошибки сетевого взаимодействия между клиентом и сервером, деление на ноль при расчетах и отсутствие данных для отображения.

В результате выполнения должны быть выделены все требования к проектируемому программному средству, определены входные и выходные данные, функциональные возможности системы, требования к интерфейсу и обработке ошибок.

### 1.2 Анализ предметной области

Предметной областью разрабатываемой системы является оценка кредитных рисков в финансовых учреждениях. Кредитный риск представляет собой вероятность того, что заемщик не сможет выполнить свои обязательства по кредиту, что приведет к финансовым потерям кредитора.

В современной банковской практике для оценки кредитных рисков используются различные статистические модели, основанные на анализе финансовых показателей. Наиболее известными и широко применяемыми являются модель Альтмана (Z-score) и модель Таффлера (T-score).

Модель Альтмана представляет собой дискриминантную модель, разработанную Эдвардом Альтманом в 1968 году для прогнозирования банкротства компаний. В разрабатываемой системе используется модифицированная версия модели, которая рассчитывает Z-score на основе коэффициента текущей ликвидности и отношения заемного капитала к пассивам. Формула модели имеет вид:

Z = -0.3877 - 1.0736 × Кт.л. + 0.0579 × (ЗК / П)

где:
- Кт.л. = коэффициент текущей ликвидности (текущие активы / текущие обязательства);
- ЗК = заемный капитал;
- П = пассивы.

Интерпретация результатов:
- Z < -0.5: низкий риск банкротства (безопасная зона);
- -0.5 ≤ Z < 0.0: средний риск (серая зона);
- Z ≥ 0.0: высокий риск банкротства (зона опасности).

Модель Таффлера, разработанная Ричардом Таффлером, представляет собой модель прогнозирования банкротства, которая использует четыре финансовых коэффициента. Формула модели имеет вид:

T = 0.53 × X₁ + 0.13 × X₂ + 0.18 × X₃ + 0.16 × X₄

где:
- X₁ = отношение прибыли от продаж к краткосрочным обязательствам;
- X₂ = отношение оборотных активов к обязательствам;
- X₃ = отношение долгосрочных обязательств к общей сумме активов;
- X₄ = отношение выручки от продаж к суммарным активам.

Интерпретация результатов:
- T > 0.3: низкий риск дефолта в течение года;
- 0.2 < T ≤ 0.3: средний кредитный риск;
- T ≤ 0.2: значительный риск потери платежеспособности (высокий риск).

Для оценки кредитных рисков физических лиц используется скоринговая модель, которая учитывает такие факторы, как доход, расходы, кредитная история, наличие залога, стаж работы и возраст заемщика. Скоринг рассчитывается по формуле:

Score = 300 + (Доход/Расход × 200) + (Кредитная история × 150) + (Залог × 100) + (Стаж × 50/20) - (Возраст/10 × 20) - (Сумма кредита/Доход × 100)

Интерпретация результатов:
- Score > 700: низкий кредитный риск;
- 500 < Score ≤ 700: средний кредитный риск;
- Score ≤ 500: высокий кредитный риск.

В разрабатываемой системе основными сущностями являются следующие. Компания – это юридическое лицо, для которого проводится оценка кредитного риска. Компания характеризуется наименованием, финансовыми показателями, такими как текущие активы, текущие обязательства, заемный капитал, пассивы, прибыль от продаж, краткосрочные и долгосрочные обязательства, общие активы, выручка от продаж. Физическое лицо – это человек, для которого проводится оценка кредитного риска. Физическое лицо характеризуется фамилией, именем, отчеством, ежемесячным доходом, ежемесячными расходами, суммой запрашиваемого кредита, кредитной историей (балл от 0 до 1), наличием залога, стажем работы, возрастом. Оценка кредитного риска компании представляет собой результат расчета показателей кредитного риска для конкретной компании на определенную дату. Оценка включает результаты расчетов по модели Альтмана (Z-score, уровень риска, рекомендация), результаты расчетов по модели Таффлера (T-score, уровень риска, рекомендация), комбинированную оценку риска и рекомендацию. Оценка кредитного риска физического лица представляет собой результат расчета кредитного скоринга для конкретного физического лица на определенную дату. Оценка включает кредитный скоринг (балл), уровень риска и рекомендацию.

Процесс работы системы включает следующие этапы. Пользователь открывает веб-интерфейс в браузере, затем выбирает тип оценки (компания или физическое лицо). Далее осуществляется ввод финансовых данных или данных физического лица через веб-форму, после чего данные отправляются на сервер через REST API. На сервере выполняется расчет показателей кредитного риска, результаты сохраняются в базе данных PostgreSQL и отображаются пользователю в веб-интерфейсе. Также предусмотрен просмотр статистики и истории оценок через веб-интерфейс.

Система обеспечивает централизованное хранение всех оценок в базе данных PostgreSQL, что позволяет анализировать историю изменений кредитных рисков, отслеживать динамику показателей компаний и физических лиц, формировать статистические отчеты для принятия управленческих решений.

---

## 2 ПРОЕКТИРОВАНИЕ СИСТЕМЫ

### 2.1 Описание логической и физической структуры системы

#### 2.1.1 Логическая структура системы

Логическая структура системы описывает основные компоненты и их взаимосвязи с точки зрения функциональности. Разрабатываемая система построена на основе клиент-серверной архитектуры и состоит из следующих основных компонентов. **Клиентское приложение (Frontend)** представляет собой веб-приложение, разработанное на фреймворке Svelte, обеспечивающее взаимодействие пользователя с системой. Клиентское приложение включает модуль пользовательского интерфейса (UI компоненты), модуль ввода и валидации данных, модуль отображения результатов, модуль работы с REST API и модуль визуализации данных (графики и диаграммы). **Серверное приложение (Backend)** представляет собой RESTful API, разработанное на фреймворке FastAPI (Python), обрабатывающее запросы от клиентов. Серверное приложение включает модуль приема и обработки HTTP-запросов (FastAPI роутеры), модуль бизнес-логики (расчет кредитных рисков), модуль работы с базой данных (SQLAlchemy ORM), модуль финансовых моделей (модели Альтмана, Таффлера, скоринговая модель) и модуль логирования. **База данных** представляет собой реляционную базу данных PostgreSQL для хранения информации об оценках кредитных рисков. **Контейнеризация** представляет собой систему развертывания на базе Docker и Docker Compose, обеспечивающую изоляцию компонентов и упрощение развертывания.

Логическая структура системы представлена на рисунке 2.1.

**Рисунок 2.1 – Логическая структура системы**

[ПЛЕЙСХОЛДЕР: Рисунок 2.1 – Логическая структура системы. Диаграмма отображает основные компоненты системы: клиентское приложение (Svelte) с модулями UI, валидации данных и визуализации, серверное приложение (FastAPI) с модулями HTTP роутеров, бизнес-логики и финансовых моделей, базу данных PostgreSQL с таблицами оценок компаний и физических лиц. Компоненты соединены стрелками, показывающими направление взаимодействия через HTTP/REST протокол.]

Взаимодействие компонентов системы осуществляется следующим образом. Клиентское приложение отправляет HTTP-запросы к серверному приложению через REST API. Серверное приложение обрабатывает запросы, выполняет бизнес-логику, взаимодействует с базой данных и возвращает результаты клиенту в формате JSON. Модуль финансовых моделей вызывается из модуля бизнес-логики для расчета показателей кредитных рисков. База данных хранит все данные системы и обеспечивает их целостность и консистентность.

#### 2.1.2 Физическая структура системы

Физическая структура системы описывает конкретную реализацию системы на уровне оборудования и сетевой инфраструктуры. Система развертывается с использованием Docker контейнеризации, что обеспечивает изоляцию компонентов и упрощение развертывания.

**Вариант развертывания: Docker Compose**

Система состоит из трех основных контейнеров: **контейнер базы данных** (PostgreSQL 15, работающий на порту 5432), **контейнер бэкенда** (FastAPI приложение на Python 3.11, работающее на порту 8000) и **контейнер фронтенда** (Svelte приложение на Node.js 20, работающее на порту 5173). Все контейнеры объединены в единую Docker сеть, что обеспечивает их взаимодействие. Данные базы данных сохраняются в именованном Docker volume для обеспечения персистентности.

Физическая структура системы представлена на рисунке 2.2.

**Рисунок 2.2 – Физическая структура системы**

[ПЛЕЙСХОЛДЕР: Рисунок 2.2 – Физическая структура системы. Диаграмма отображает развертывание системы в Docker контейнерах: пользователь взаимодействует с системой через веб-браузер, который подключен к Docker Host, содержащему три контейнера (Frontend на порту 5173, Backend на порту 8000, Database на порту 5432), объединенные в сеть credit-risk-network, с персистентным хранилищем postgres_data для базы данных.]

Для обеспечения отказоустойчивости и масштабируемости система может быть развернута в облачной инфраструктуре (AWS, Azure, Google Cloud) с использованием оркестраторов контейнеров (Kubernetes, Docker Swarm).

### 2.2 Моделирование взаимодействия компонентов системы

Моделирование взаимодействия компонентов системы направлено на обеспечение четкого представления о порядке обмена данными и вызовов между компонентами. Рассмотрим основные сценарии взаимодействия:

**Сценарий 1: Оценка кредитного риска компании**

Последовательность взаимодействия компонентов при оценке кредитного риска компании представлена на рисунке 2.3.

**Рисунок 2.3 – Диаграмма последовательности: Оценка кредитного риска компании**

[ПЛЕЙСХОЛДЕР: Рисунок 2.3 – Диаграмма последовательности: Оценка кредитного риска компании. Диаграмма отображает последовательность взаимодействия между компонентами: клиент отправляет POST запрос на /api/predict, FastAPI Router валидирует данные, вызывает расчеты по моделям Альтмана и Таффлера через модуль финансовых моделей, выполняет комбинированную оценку, сохраняет результаты в PostgreSQL и возвращает JSON ответ клиенту.]

**Сценарий 2: Получение статистики**

При получении статистики клиент отправляет GET-запрос на эндпоинт `/api/statistics/companies` или `/api/statistics/individuals` с опциональными query-параметрами для фильтрации (company_name или full_name, start_date, end_date). Серверное приложение через FastAPI Router получает параметры запроса, валидирует их, обращается к базе данных через SQLAlchemy ORM, выполняет SQL-запрос с применением фильтров и сортировки, получает результаты из базы данных, формирует JSON-ответ с массивом оценок и возвращает его клиенту. Клиентское приложение получает данные и отображает их в таблицах через компоненты CompanyTable или IndividualTable.

**Сценарий 3: Просмотр истории оценок**

При просмотре истории оценок клиент отправляет GET-запрос на эндпоинт `/api/statistics/companies/{name}/history` или `/api/statistics/individuals/{name}/history`, где {name} – наименование компании или ФИО физического лица. Серверное приложение извлекает параметр name из пути запроса, выполняет SQL-запрос к базе данных для получения всех оценок для указанного заемщика, упорядочивает результаты по дате оценки, формирует JSON-ответ с массивом исторических данных и возвращает его клиенту. Клиентское приложение получает данные и отображает их в виде графика через компонент HistoryChart, который использует библиотеку Chart.js для визуализации динамики показателей кредитных рисков во времени.

**Сценарий 4: Удаление оценки**

При удалении оценки клиент отправляет DELETE-запрос на эндпоинт `/api/statistics/companies/{id}` или `/api/statistics/individuals/{id}`, где {id} – уникальный идентификатор записи. Серверное приложение извлекает параметр id из пути запроса, выполняет SQL-запрос для поиска записи в базе данных, проверяет существование записи, удаляет запись из базы данных, возвращает статус успешного удаления клиенту. Клиентское приложение обновляет список оценок, удаляя удаленную запись из интерфейса.

### 2.3 Проектирование моделей данных

В системе используются следующие основные модели данных:

#### 2.3.1 Модель CompanyAssessment

Модель CompanyAssessment представляет оценку кредитного риска компании и содержит все необходимые поля для хранения исходных данных и результатов расчетов. Структура модели представлена в таблице 2.1.

**Таблица 2.1 – Структура модели CompanyAssessment**

| Поле | Тип | Описание | Ограничения |
|------|-----|----------|-------------|
| id | INTEGER | Уникальный идентификатор | PRIMARY KEY, AUTO INCREMENT |
| company_name | VARCHAR(255) | Наименование компании | NOT NULL, INDEX |
| assessment_date | TIMESTAMP | Дата оценки | NOT NULL, INDEX |
| current_assets | FLOAT | Текущие активы | NOT NULL, >= 0 |
| current_liabilities | FLOAT | Текущие обязательства | NOT NULL, > 0 |
| debt_capital | FLOAT | Заемный капитал | NOT NULL, >= 0 |
| liabilities | FLOAT | Пассивы | NOT NULL, > 0 |
| sales_profit | FLOAT | Прибыль от продаж | NOT NULL |
| short_term_liabilities | FLOAT | Краткосрочные обязательства | NOT NULL, > 0 |
| long_term_liabilities | FLOAT | Долгосрочные обязательства | NOT NULL, >= 0 |
| total_assets | FLOAT | Общие активы | NOT NULL, > 0 |
| sales | FLOAT | Выручка от продаж | NOT NULL, >= 0 |
| altman_z_score | FLOAT | Z-score по модели Альтмана | NOT NULL |
| altman_risk_level | VARCHAR(20) | Уровень риска по Альтману | NOT NULL |
| altman_recommendation | TEXT | Рекомендация по Альтману | NOT NULL |
| taffler_z_score | FLOAT | T-score по модели Таффлера | NOT NULL |
| taffler_risk_level | VARCHAR(20) | Уровень риска по Таффлеру | NOT NULL |
| taffler_recommendation | TEXT | Рекомендация по Таффлеру | NOT NULL |
| combined_risk_level | VARCHAR(20) | Комбинированный уровень риска | NOT NULL |
| combined_recommendation | TEXT | Комбинированная рекомендация | NOT NULL |
| created_at | TIMESTAMP | Дата создания записи | NOT NULL, DEFAULT NOW() |
| updated_at | TIMESTAMP | Дата обновления записи | NOT NULL, DEFAULT NOW() |

#### 2.3.2 Модель IndividualAssessment

Модель IndividualAssessment представляет оценку кредитного риска физического лица. Структура модели представлена в таблице 2.2.

**Таблица 2.2 – Структура модели IndividualAssessment**

| Поле | Тип | Описание | Ограничения |
|------|-----|----------|-------------|
| id | INTEGER | Уникальный идентификатор | PRIMARY KEY, AUTO INCREMENT |
| full_name | VARCHAR(255) | ФИО физического лица | NOT NULL, INDEX |
| assessment_date | TIMESTAMP | Дата оценки | NOT NULL, INDEX |
| monthly_income | FLOAT | Ежемесячный доход | NOT NULL, > 0 |
| monthly_expenses | FLOAT | Ежемесячные расходы | NOT NULL, > 0 |
| credit_amount | FLOAT | Сумма кредита | NOT NULL, > 0 |
| credit_history_score | FLOAT | Оценка кредитной истории | NOT NULL, 0-1 |
| has_collateral | BOOLEAN | Наличие залога | NOT NULL, DEFAULT FALSE |
| employment_years | FLOAT | Трудовой стаж в годах | NOT NULL, >= 0 |
| age | INTEGER | Возраст | NOT NULL, 18-100 |
| credit_score | FLOAT | Кредитный скоринг | NOT NULL, 300-850 |
| risk_level | VARCHAR(20) | Уровень риска | NOT NULL |
| recommendation | TEXT | Рекомендация | NOT NULL |
| created_at | TIMESTAMP | Дата создания записи | NOT NULL, DEFAULT NOW() |
| updated_at | TIMESTAMP | Дата обновления записи | NOT NULL, DEFAULT NOW() |

### 2.4 Проектирование REST API

Серверное приложение предоставляет REST API для взаимодействия с клиентским приложением. Основные эндпоинты API представлены в таблице 2.3.

**Таблица 2.3 – Эндпоинты REST API**

| Метод | Путь | Описание | Параметры |
|-------|------|----------|-----------|
| GET | /api/health | Проверка статуса сервера | - |
| GET | /api/model-info | Получение информации о моделях | - |
| POST | /api/predict | Оценка кредитного риска компании | JSON: FinancialDataRequest |
| POST | /api/predict/individual | Оценка кредитного риска физ. лица | JSON: IndividualDataRequest |
| GET | /api/statistics/companies | Получение статистики по компаниям | Query: company_name, start_date, end_date |
| GET | /api/statistics/individuals | Получение статистики по физ. лицам | Query: full_name, start_date, end_date |
| GET | /api/statistics/companies/{name}/history | История оценок компании | Path: name |
| GET | /api/statistics/individuals/{name}/history | История оценок физ. лица | Path: name |
| DELETE | /api/statistics/companies/{id} | Удаление оценки компании | Path: id |
| DELETE | /api/statistics/individuals/{id} | Удаление оценки физ. лица | Path: id |

### 2.5 Проектирование интерфейса

Интерфейс клиентского приложения состоит из следующих основных страниц:

**Главная страница** – страница для выбора типа оценки (компания или физическое лицо), ввода данных и отображения результатов.

**Страница статистики** – страница для просмотра статистики и истории оценок с возможностью фильтрации и визуализации данных.

Основные компоненты интерфейса:

- **BorrowerTypeToggle** – переключатель типа заемщика (компания/физическое лицо).
- **FinancialForm** – форма для ввода финансовых данных компании.
- **IndividualForm** – форма для ввода данных физического лица.
- **PredictionResults** – компонент для отображения результатов оценки компании.
- **IndividualResult** – компонент для отображения результатов оценки физического лица.
- **StatisticsFilters** – компонент для фильтрации статистики.
- **CompanyTable** – таблица со статистикой по компаниям.
- **IndividualTable** – таблица со статистикой по физическим лицам.
- **HistoryChart** – график для визуализации истории оценок.

Интерфейс реализован с использованием компонентного подхода фреймворка Svelte и библиотеки TailwindCSS для стилизации, что обеспечивает современный и адаптивный дизайн.

---

## 3 РЕАЛИЗАЦИЯ ПРОГРАММНОГО МОДУЛЯ

### 3.1 Структура проекта

Проект организован по принципам чистой архитектуры с разделением кода на логические слои. Структура проекта представлена ниже:

```
project/
├── backend/
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py                 # Точка входа FastAPI приложения
│   │   ├── database.py             # Подключение к БД, создание сессий
│   │   ├── db_models.py            # SQLAlchemy модели (CompanyAssessment, IndividualAssessment)
│   │   ├── models.py               # Pydantic схемы для валидации запросов/ответов
│   │   ├── api/
│   │   │   ├── __init__.py
│   │   │   ├── routes.py           # API маршруты (все эндпоинты)
│   │   │   └── schemas.py          # Дополнительные схемы валидации
│   │   └── financial_models/
│   │       ├── __init__.py
│   │       ├── config.py           # Конфигурация моделей
│   │       ├── model.py             # Базовый класс модели, обертка для расчетов
│   │       ├── financial_models.py # Модели Альтмана и Таффлера
│   │       └── individual_models.py # Скоринговая модель для физ. лиц
│   ├── config.py                   # Конфигурация приложения (переменные окружения)
│   ├── requirements.txt            # Зависимости Python
│   ├── Dockerfile                  # Образ для контейнеризации бэкенда
│   └── scripts/
│       ├── __init__.py
│       ├── README.md
│       └── seed_database.py        # Скрипт для заполнения БД тестовыми данными
├── frontend/
│   ├── src/
│   │   ├── app.html                # HTML шаблон приложения
│   │   ├── app.css                 # Глобальные стили
│   │   ├── routes/
│   │   │   ├── +layout.svelte      # Общий layout приложения
│   │   │   ├── +page.svelte        # Главная страница
│   │   │   └── statistics/
│   │   │       └── +page.svelte    # Страница статистики
│   │   └── lib/
│   │       ├── api.ts              # Клиент API (все HTTP запросы)
│   │       ├── stores.ts            # Svelte stores для управления состоянием
│   │       ├── index.js             # Экспорт утилит
│   │       ├── assets/
│   │       │   └── favicon.svg      # Иконка приложения
│   │       └── components/         # Компоненты UI
│   │           ├── BorrowerTypeToggle.svelte
│   │           ├── FinancialForm.svelte
│   │           ├── IndividualForm.svelte
│   │           ├── PredictionResults.svelte
│   │           ├── IndividualResult.svelte
│   │           ├── CompanyTable.svelte
│   │           ├── IndividualTable.svelte
│   │           ├── HistoryChart.svelte
│   │           ├── StatisticsFilters.svelte
│   │           ├── ModelInfoCard.svelte
│   │           ├── PredictionHistory.svelte
│   │           ├── AltmanResult.svelte
│   │           ├── TafflerResult.svelte
│   │           ├── CombinedRiskAlert.svelte
│   │           ├── RiskBadge.svelte
│   │           ├── FormField.svelte
│   │           └── StatisticsHeader.svelte
│   ├── static/
│   │   └── robots.txt              # Файл для поисковых роботов
│   ├── Dockerfile                  # Образ для контейнеризации фронтенда
│   ├── package.json                # Зависимости Node.js
│   ├── package-lock.json           # Зафиксированные версии зависимостей
│   ├── svelte.config.js           # Конфигурация SvelteKit
│   ├── vite.config.js              # Конфигурация Vite
│   ├── eslint.config.js            # Конфигурация ESLint
│   └── jsconfig.json               # Конфигурация JavaScript/TypeScript
├── docs/
│   ├── Пояснительная_записка.md    # Пояснительная записка к проекту
│   └── ...                         # Другие документы
├── docker-compose.yml              # Конфигурация Docker Compose
└── README.md                       # Документация проекта
```

Проект следует принципам модульности и разделения ответственности. Серверная часть организована в виде многоуровневой архитектуры с четким разделением на слои представления (API роутеры), бизнес-логики (модули финансовых моделей) и доступа к данным (SQLAlchemy ORM). Клиентская часть построена на компонентной архитектуре SvelteKit с разделением на страницы, компоненты и утилиты.

### 3.2 Реализация серверной части приложения

#### 3.2.1 Архитектура серверного приложения

Серверное приложение построено на основе многоуровневой архитектуры, включающей следующие уровни: **уровень представления (Presentation Layer)** – FastAPI роутеры, обрабатывающие входящие HTTP-запросы, **уровень бизнес-логики (Business Logic Layer)** – модули расчета кредитных рисков и обработки данных, **уровень доступа к данным (Data Access Layer)** – SQLAlchemy ORM для работы с базой данных, **уровень данных (Data Layer)** – база данных PostgreSQL.

#### 3.2.2 Реализация FastAPI приложения

FastAPI приложение инициализируется в файле `app/main.py`. Основные компоненты включают создание экземпляра FastAPI приложения с метаданными (название, описание, версия), которые берутся из конфигурационного файла `config.py`, настройку логирования с использованием модуля logging Python, где уровень логирования и формат определяются в конфигурации, настройку CORS middleware для разрешения запросов от клиентского приложения, что позволяет фронтенду на порту 5173 взаимодействовать с бэкендом на порту 8000, подключение роутеров API через метод `app.include_router(router)`, где router импортируется из модуля `app.api.routes`, создание таблиц базы данных при запуске приложения через событие `startup`, которое вызывает `Base.metadata.create_all(bind=engine)` для автоматического создания всех таблиц, определенных в SQLAlchemy моделях, глобальный обработчик исключений `@app.exception_handler(Exception)` для обработки всех необработанных исключений, логирования ошибок и возврата понятных сообщений об ошибках клиенту в формате JSON.

Пример инициализации приложения:

```python
app = FastAPI(
    title=config.APP_TITLE,
    description=config.APP_DESCRIPTION,
    version=config.APP_VERSION
)

app.add_middleware(
    CORSMiddleware,
    allow_origins=config.CORS_ORIGINS,
    allow_credentials=config.CORS_ALLOW_CREDENTIALS,
    allow_methods=config.CORS_ALLOW_METHODS,
    allow_headers=config.CORS_ALLOW_HEADERS,
)

app.include_router(router)
```

Дополнительно реализован корневой эндпоинт `GET /`, который возвращает информацию о API, включая версию, ссылки на документацию и список доступных моделей. FastAPI автоматически генерирует интерактивную документацию API по адресу `/docs` (Swagger UI) и `/redoc` (ReDoc), что упрощает тестирование и интеграцию с системой.

#### 3.2.3 Реализация API роутеров

API роутеры реализованы в файле `app/api/routes.py` с использованием APIRouter из FastAPI. Роутер создается с префиксом `/api` и тегом `credit-risk` для группировки эндпоинтов в документации. Основные эндпоинты:

- **GET /api/health** – проверка статуса сервера. Возвращает объект HealthResponse с полями status ("healthy"), message и timestamp. Используется для мониторинга работоспособности системы.

- **GET /api/model-info** – получение информации о доступных финансовых моделях. Возвращает объект ModelInfoResponse с описанием моделей Альтмана, Таффлера и скоринговой модели, включая формулы, пороговые значения и интерпретацию результатов.

- **POST /api/predict** – оценка кредитного риска компании. Принимает объект FinancialDataRequest с финансовыми показателями компании (наименование, дата оценки, текущие активы, обязательства и т.д.). Валидирует данные через Pydantic, преобразует в словарь, вызывает функцию `calculate_bankruptcy_risk()` из модуля финансовых моделей, которая выполняет расчеты по моделям Альтмана и Таффлера, получает комбинированную оценку риска. Создает объект CompanyAssessment, сохраняет его в базу данных через SQLAlchemy сессию, возвращает объект PredictionResponse с результатами расчетов.

- **POST /api/predict/individual** – оценка кредитного риска физического лица. Принимает объект IndividualDataRequest с данными физического лица (ФИО, доход, расходы, кредитная история и т.д.). Валидирует данные, вызывает функцию `calculate_individual_risk()` из модуля финансовых моделей для расчета кредитного скоринга, сохраняет результаты в таблицу IndividualAssessment, возвращает объект IndividualPredictionResponse.

- **GET /api/statistics/companies** – получение статистики по компаниям. Принимает опциональные query-параметры: company_name (фильтр по наименованию), start_date и end_date (фильтр по диапазону дат). Выполняет SQL-запрос к таблице CompanyAssessment с применением фильтров, упорядочивает результаты по дате оценки (по убыванию), возвращает список всех оценок в формате JSON.

- **GET /api/statistics/individuals** – получение статистики по физическим лицам. Аналогично предыдущему эндпоинту, но работает с таблицей IndividualAssessment и фильтрует по full_name.

- **GET /api/statistics/companies/{name}/history** – получение истории оценок конкретной компании. Извлекает параметр name из пути запроса, выполняет SQL-запрос для получения всех оценок компании с указанным наименованием, упорядочивает по дате, возвращает массив исторических данных.

- **GET /api/statistics/individuals/{name}/history** – получение истории оценок конкретного физического лица. Аналогично предыдущему, но для физических лиц.

- **DELETE /api/statistics/companies/{id}** – удаление оценки компании по ID. Извлекает параметр id из пути, находит запись в базе данных, проверяет существование, удаляет запись, возвращает статус успешного удаления или ошибку 404, если запись не найдена.

- **DELETE /api/statistics/individuals/{id}** – удаление оценки физического лица по ID. Аналогично предыдущему эндпоинту.

Каждый эндпоинт выполняет следующие действия: валидация входных данных с использованием Pydantic схем, автоматическая проверка типов и ограничений, логирование запроса с использованием модуля logging для отслеживания операций, вызов соответствующего метода бизнес-логики из модуля финансовых моделей или работы с базой данных, обработка результатов и формирование HTTP-ответа с правильным статус-кодом (200 для успеха, 404 для не найдено, 500 для ошибок сервера), обработка исключений через try-except блоки, логирование ошибок и формирование понятных сообщений об ошибках для клиента, использование dependency injection через `Depends(get_db)` для получения сессии базы данных, которая автоматически закрывается после обработки запроса.

#### 3.2.4 Реализация модуля финансовых моделей

Модуль финансовых моделей реализован в пакете `app/financial_models/` и содержит следующие компоненты:

**Файл `financial_models.py`** содержит функции для расчета кредитных рисков компаний:

- **calculate_altman_z_score()** – рассчитывает Z-score по модели Альтмана. Принимает словарь с финансовыми показателями (current_assets, current_liabilities, debt_capital, liabilities). Выполняет проверку на положительность обязательных значений, рассчитывает коэффициент текущей ликвидности (current_assets / current_liabilities), отношение заемного капитала к пассивам (debt_capital / liabilities), применяет формулу модели: Z = -0.3877 - 1.0736 × Кт.л. + 0.0579 × (ЗК / П). Определяет уровень риска на основе пороговых значений: Z < -0.5 (низкий риск), -0.5 ≤ Z < 0.0 (средний риск), Z ≥ 0.0 (высокий риск). Формирует текстовую рекомендацию в зависимости от уровня риска. Возвращает кортеж (z_score, risk_level, recommendation). Обрабатывает исключения и логирует ошибки.

- **calculate_taffler_score()** – рассчитывает T-score по модели Таффлера. Принимает словарь с финансовыми показателями (sales_profit, short_term_liabilities, current_assets, liabilities, long_term_liabilities, total_assets, sales). Выполняет проверку на положительность обязательных значений, рассчитывает четыре коэффициента: X₁ = прибыль от продаж / краткосрочные обязательства, X₂ = оборотные активы / обязательства, X₃ = долгосрочные обязательства / общие активы, X₄ = выручка от продаж / суммарные активы. Применяет формулу модели: T = 0.53 × X₁ + 0.13 × X₂ + 0.18 × X₃ + 0.16 × X₄. Определяет уровень риска: T > 0.3 (низкий риск), 0.2 < T ≤ 0.3 (средний риск), T ≤ 0.2 (высокий риск). Формирует рекомендацию и возвращает кортеж (t_score, risk_level, recommendation).

- **calculate_combined_risk()** – комбинирует результаты моделей Альтмана и Таффлера для общей оценки риска. Принимает значения z_score и t_score, а также соответствующие уровни риска. Определяет комбинированный уровень риска на основе логики: если обе модели показывают низкий риск – низкий, если обе показывают высокий риск – высокий, в остальных случаях – средний. Формирует комбинированную рекомендацию, учитывающую результаты обеих моделей. Возвращает кортеж (combined_risk_level, combined_recommendation).

**Файл `individual_models.py`** содержит функцию для расчета кредитных рисков физических лиц:

- **calculate_individual_credit_score()** – рассчитывает кредитный скоринг для физического лица. Принимает словарь с данными (monthly_income, monthly_expenses, credit_amount, credit_history_score, has_collateral, employment_years, age). Выполняет валидацию данных: проверяет положительность дохода, расходов и суммы кредита, проверяет диапазон кредитной истории (0-1), проверяет диапазон возраста (18-100). Рассчитывает скоринг по формуле: Score = 300 + (Доход/Расход × 200) + (Кредитная история × 150) + (Залог × 100) + (Стаж × 50/20) - (Возраст/10 × 20) - (Сумма кредита/Доход × 100). Ограничивает результат диапазоном 300-850. Определяет уровень риска: Score > 700 (низкий риск), 500 < Score ≤ 700 (средний риск), Score ≤ 500 (высокий риск). Формирует рекомендацию и возвращает кортеж (credit_score, risk_level, recommendation).

**Файл `model.py`** содержит функции-обертки:

- **calculate_bankruptcy_risk()** – обертка для расчета риска банкротства компании. Вызывает функции calculate_altman_z_score() и calculate_taffler_score(), затем calculate_combined_risk(), объединяет результаты в словарь и возвращает его.

- **calculate_individual_risk()** – обертка для расчета риска физического лица. Вызывает функцию calculate_individual_credit_score() и возвращает результаты в формате словаря.

- **get_model_info()** – возвращает информацию о всех доступных моделях, включая описания, формулы и пороговые значения.

Все функции содержат проверку входных данных на корректность, обработку исключений (деление на ноль, отрицательные значения, выход за диапазоны) и выбрасывают исключения ValueError с понятными сообщениями при некорректных значениях. Используется модуль logging для отслеживания операций и ошибок.

#### 3.2.5 Реализация модуля доступа к данным

Модуль доступа к данным реализован с использованием SQLAlchemy ORM версии 2.0+. Основные компоненты:

**Файл `app/database.py`** содержит настройку подключения к базе данных:

- **DATABASE_URL** – строка подключения к базе данных PostgreSQL, формируется из переменных окружения (хост, порт, имя пользователя, пароль, имя базы данных) или берется из конфигурационного файла.

- **engine** – объект SQLAlchemy Engine, создается через функцию `create_engine()` с параметрами подключения, пулом соединений и настройками для работы с асинхронными операциями.

- **SessionLocal** – фабрика сессий базы данных, создается через функцию `sessionmaker()` с привязкой к engine, настройками автокоммита и автопромывки.

- **Base** – базовый класс для всех моделей данных, создается через функцию `declarative_base()`.

- **get_db()** – функция-генератор для dependency injection в FastAPI. Создает новую сессию базы данных, передает ее в обработчик запроса через yield, гарантирует закрытие сессии и откат транзакции в случае ошибки через блок finally.

**Файл `app/db_models.py`** содержит SQLAlchemy модели данных:

- **CompanyAssessment** – класс модели для таблицы оценок компаний. Наследуется от Base, определяет структуру таблицы `company_assessments` с полями: id (Integer, первичный ключ, автоинкремент), company_name (String, индекс), assessment_date (DateTime, индекс), финансовые показатели (Float), результаты расчетов (Float, String, Text), created_at и updated_at (DateTime с дефолтными значениями). Использует декларативный стиль SQLAlchemy.

- **IndividualAssessment** – класс модели для таблицы оценок физических лиц. Аналогично CompanyAssessment, определяет структуру таблицы `individual_assessments` с полями для данных физического лица и результатов скоринга.

Обе модели используют типизацию Python и аннотации типов для улучшения читаемости кода и поддержки IDE.

**Пример использования:**

```python
@router.post("/predict")
async def predict_bankruptcy_risk(
    financial_data: FinancialDataRequest,
    db: Session = Depends(get_db)
) -> PredictionResponse:
    # Использование сессии db для работы с БД
    db_assessment = CompanyAssessment(
        company_name=financial_data.company_name,
        assessment_date=datetime.strptime(financial_data.assessment_date, "%Y-%m-%d"),
        current_assets=financial_data.current_assets,
        # ... остальные поля
    )
    db.add(db_assessment)
    db.commit()
    db.refresh(db_assessment)
```

SQLAlchemy автоматически генерирует SQL-запросы на основе операций с моделями, обеспечивает защиту от SQL-инъекций через параметризованные запросы, поддерживает транзакции и обеспечивает целостность данных через ограничения базы данных.

#### 3.2.6 Конфигурация серверного приложения

Серверное приложение настраивается через переменные окружения и файл `backend/config.py`. Файл конфигурации использует модуль `os` для чтения переменных окружения с fallback на значения по умолчанию. Настройки включают:

- **Метаданные приложения** – APP_TITLE (название приложения), APP_DESCRIPTION (описание), APP_VERSION (версия). Используются при инициализации FastAPI приложения и отображаются в документации API.

- **Настройки сервера** – API_HOST (адрес прослушивания, по умолчанию "0.0.0.0" для прослушивания на всех интерфейсах), API_PORT (порт сервера, по умолчанию 8000), API_RELOAD (автоперезагрузка при изменении кода, по умолчанию False для production).

- **Настройки базы данных** – DATABASE_URL формируется из отдельных параметров (DB_HOST, DB_PORT, DB_USER, DB_PASSWORD, DB_NAME) или может быть задан напрямую. Используется для подключения к PostgreSQL через SQLAlchemy.

- **Настройки логирования** – LOG_LEVEL (уровень логирования: DEBUG, INFO, WARNING, ERROR, CRITICAL, по умолчанию "INFO"), LOG_FORMAT (формат логов, по умолчанию включает время, уровень, модуль и сообщение).

- **Настройки CORS** – CORS_ORIGINS (список разрешенных источников запросов, по умолчанию ["http://localhost:5173"]), CORS_ALLOW_CREDENTIALS (разрешение отправки cookies, по умолчанию True), CORS_ALLOW_METHODS (разрешенные HTTP методы, по умолчанию ["*"]), CORS_ALLOW_HEADERS (разрешенные заголовки, по умолчанию ["*"]).

**Таблица 3.1 – Конфигурационные параметры сервера**

| Параметр | Значение по умолчанию | Описание |
|----------|----------------------|----------|
| APP_TITLE | "Credit Risk Assessment API" | Название приложения |
| APP_DESCRIPTION | "API для оценки кредитных рисков" | Описание приложения |
| APP_VERSION | "1.0.0" | Версия приложения |
| API_HOST | "0.0.0.0" | Адрес прослушивания |
| API_PORT | 8000 | Порт сервера |
| API_RELOAD | False | Автоперезагрузка при изменении кода |
| DATABASE_URL | postgresql://... | Строка подключения к БД |
| DB_HOST | "db" | Хост базы данных (в Docker) |
| DB_PORT | 5432 | Порт базы данных |
| DB_USER | "credit_risk" | Пользователь БД |
| DB_PASSWORD | "credit_risk_password" | Пароль БД |
| DB_NAME | "credit_risk_db" | Имя базы данных |
| LOG_LEVEL | "INFO" | Уровень логирования |
| LOG_FORMAT | "%(asctime)s - %(name)s - %(levelname)s - %(message)s" | Формат логов |
| CORS_ORIGINS | ["http://localhost:5173"] | Разрешенные источники запросов |
| CORS_ALLOW_CREDENTIALS | True | Разрешение отправки cookies |
| CORS_ALLOW_METHODS | ["*"] | Разрешенные HTTP методы |
| CORS_ALLOW_HEADERS | ["*"] | Разрешенные заголовки |

В Docker контейнере переменные окружения задаются в файле `docker-compose.yml` через секцию `environment` для каждого сервиса, что позволяет легко изменять конфигурацию без изменения кода.

### 3.3 Реализация клиентской части приложения

#### 3.3.1 Архитектура клиентского приложения

Клиентское приложение построено на основе фреймворка SvelteKit, который обеспечивает компонентную архитектуру и маршрутизацию на основе файловой системы. Приложение использует **Svelte** – реактивный фреймворк для создания пользовательского интерфейса, **SvelteKit** – фреймворк для построения приложений на базе Svelte, **TailwindCSS** – утилитарную CSS-библиотеку для стилизации, **DaisyUI** – компонентную библиотеку для TailwindCSS, **Chart.js** – библиотеку для построения графиков.

#### 3.3.2 Реализация главной страницы

Главная страница (`src/routes/+page.svelte`) является центральным элементом приложения и обеспечивает инициализацию состояния при монтировании компонента (через `onMount`), когда загружается информация о моделях через функцию `getModelInfo()` из API клиента, результаты сохраняются в Svelte store `modelInfo` для использования в компоненте ModelInfoCard. Переключатель типа заемщика реализован через компонент BorrowerTypeToggle, который позволяет выбрать между "company" (компания) и "individual" (физическое лицо), выбранный тип хранится в реактивной переменной `borrowerType`. В зависимости от выбранного типа отображается компонент FinancialForm (для компаний) или IndividualForm (для физических лиц), оба компонента принимают объекты данных через props, реализуют валидацию полей на клиентской стороне, отображают сообщения об ошибках под каждым полем, используют компонент FormField для единообразного отображения полей ввода. Функция `handleSubmit()` вызывается при отправке формы, выполняет дополнительную валидацию данных, устанавливает флаг загрузки `isLoading`, вызывает соответствующую функцию API (`predictCreditRisk()` или `predictIndividualCreditRisk()`), обрабатывает успешный ответ и сохраняет результаты в реактивные переменные `prediction` или `individualPrediction`, обрабатывает ошибки и отображает сообщения пользователю, обновляет историю оценок через store `predictionHistory`. Компонент PredictionResults отображает результаты оценки компании, включая отдельные карточки для модели Альтмана (AltmanResult), модели Таффлера (TafflerResult) и комбинированную оценку (CombinedRiskAlert), компонент IndividualResult отображает результаты оценки физического лица с кредитным скорингом и уровнем риска, оба компонента используют цветовую индикацию уровня риска через компонент RiskBadge (зеленый для низкого, желтый для среднего, красный для высокого риска). Компонент ModelInfoCard отображает информацию о доступных финансовых моделях, загруженную из API, включая описания, формулы и интерпретацию результатов. Компонент PredictionHistory отображает список последних оценок из store `predictionHistory`, позволяет просмотреть детали каждой оценки, реализует навигацию к странице статистики для просмотра полной истории.

Страница использует реактивные переменные Svelte (`$:`) для автоматического обновления интерфейса при изменении данных, обработчики событий для взаимодействия с пользователем, условный рендеринг (`{#if}`) для отображения разных компонентов в зависимости от состояния, директивы Svelte для работы с асинхронными данными и загрузкой.

#### 3.3.3 Реализация API клиента

API клиент реализован в файле `src/lib/api.ts` и обеспечивает взаимодействие с сервером через REST API. Файл содержит TypeScript интерфейсы для типизации данных и функции для выполнения HTTP-запросов.

Базовые настройки включают константу `API_BASE_URL`, которая определяет базовый URL сервера, берется из переменной окружения `VITE_API_URL` или использует значение по умолчанию `http://localhost:8000`, и функцию `handleResponse()`, которая обрабатывает HTTP-ответы, проверяет статус код, парсит JSON, выбрасывает исключения при ошибках.

Интерфейсы TypeScript включают `FinancialData` – интерфейс для данных компании (company_name, assessment_date, финансовые показатели), `IndividualData` – интерфейс для данных физического лица (full_name, assessment_date, доход, расходы и т.д.), `PredictionResponse` – интерфейс для ответа с результатами оценки компании, `IndividualPredictionResponse` – интерфейс для ответа с результатами оценки физического лица, `ModelInfoResponse` – интерфейс для информации о моделях.

**Основные функции:**

- **getModelInfo()** – отправляет GET-запрос на `/api/model-info`, возвращает объект ModelInfoResponse с информацией о всех доступных финансовых моделях. Используется для отображения информации о моделях в компоненте ModelInfoCard.

- **predictCreditRisk()** – отправляет POST-запрос на `/api/predict` с телом запроса в формате JSON, содержащим объект FinancialData. Обрабатывает ответ, возвращает объект PredictionResponse с результатами расчетов по моделям Альтмана и Таффлера. Обрабатывает ошибки валидации и сетевые ошибки.

- **predictIndividualCreditRisk()** – отправляет POST-запрос на `/api/predict/individual` с объектом IndividualData. Возвращает объект IndividualPredictionResponse с результатами скоринга. Аналогично обрабатывает ошибки.

- **getCompanyStatistics()** – отправляет GET-запрос на `/api/statistics/companies` с опциональными query-параметрами (company_name, start_date, end_date). Формирует URL с параметрами через URLSearchParams. Возвращает массив объектов CompanyAssessment. Используется для заполнения таблицы CompanyTable на странице статистики.

- **getIndividualStatistics()** – отправляет GET-запрос на `/api/statistics/individuals` с параметрами full_name, start_date, end_date. Возвращает массив объектов IndividualAssessment. Используется для заполнения таблицы IndividualTable.

- **getCompanyHistory()** – отправляет GET-запрос на `/api/statistics/companies/{name}/history`, где {name} – наименование компании. Возвращает массив исторических оценок компании, упорядоченных по дате. Используется для построения графика HistoryChart.

- **getIndividualHistory()** – отправляет GET-запрос на `/api/statistics/individuals/{name}/history` с ФИО физического лица. Возвращает историю оценок. Аналогично используется для графика.

- **deleteCompanyAssessment()** – отправляет DELETE-запрос на `/api/statistics/companies/{id}`. Возвращает статус успешного удаления или выбрасывает исключение при ошибке. Используется для удаления записей из таблицы CompanyTable.

- **deleteIndividualAssessment()** – отправляет DELETE-запрос на `/api/statistics/individuals/{id}`. Аналогично предыдущей функции.

Все функции используют fetch API для отправки HTTP-запросов, обрабатывают ошибки через try-catch блоки, преобразуют ошибки в понятные исключения с сообщениями для пользователя, используют async/await для асинхронных операций, возвращают типизированные данные согласно интерфейсам TypeScript.

#### 3.3.4 Реализация компонентов интерфейса

Компоненты интерфейса реализованы как Svelte компоненты в директории `src/lib/components/`. Все компоненты используют библиотеку TailwindCSS и DaisyUI для стилизации, обеспечивая единообразный и современный дизайн.

**Компоненты форм:**

- **FinancialForm** – форма для ввода финансовых данных компании. Принимает через props объект formData, объект formErrors для отображения ошибок валидации, флаг isLoading для блокировки формы во время загрузки, функцию handleSubmit для обработки отправки. Использует компонент FormField для каждого поля ввода. Поля организованы в сетку (grid) для адаптивного отображения. Реализует валидацию на клиентской стороне: проверка на пустые обязательные поля, проверка на положительность числовых значений, проверка формата даты. Отображает сообщения об ошибках под каждым полем.

- **IndividualForm** – форма для ввода данных физического лица. Аналогично FinancialForm, но содержит поля для физического лица: ФИО, доход, расходы, сумма кредита, кредитная история (слайдер от 0 до 1), наличие залога (чекбокс), стаж работы, возраст. Реализует валидацию диапазонов: кредитная история 0-1, возраст 18-100, положительность дохода и расходов.

- **FormField** – переиспользуемый компонент для отображения поля ввода. Принимает label, value (bind), error, required, hint, type, placeholder. Отображает метку поля, поле ввода с соответствующим типом, подсказку (hint), сообщение об ошибке (если есть). Использует классы TailwindCSS для стилизации.

**Компоненты отображения результатов:**

- **PredictionResults** – компонент для отображения результатов оценки компании. Принимает объект prediction типа PredictionResponse. Отображает три карточки: AltmanResult (Z-score, уровень риска, рекомендация), TafflerResult (T-score, уровень риска, рекомендация), CombinedRiskAlert (комбинированная оценка). Использует компонент RiskBadge для цветовой индикации уровня риска. Анимация появления результатов через CSS классы.

- **IndividualResult** – компонент для отображения результатов оценки физического лица. Принимает объект individualPrediction. Отображает кредитный скоринг (большое число), уровень риска с цветовой индикацией, текстовую рекомендацию. Использует RiskBadge для визуализации уровня риска.

- **AltmanResult** – компонент для отображения результатов модели Альтмана. Отображает Z-score с округлением до 2 знаков после запятой, уровень риска, рекомендацию. Использует цветовую схему в зависимости от уровня риска.

- **TafflerResult** – компонент для отображения результатов модели Таффлера. Аналогично AltmanResult, но для T-score.

- **CombinedRiskAlert** – компонент для отображения комбинированной оценки риска. Отображает предупреждение (alert) с комбинированным уровнем риска и рекомендацией. Использует цветовую схему DaisyUI для alert компонентов.

- **RiskBadge** – переиспользуемый компонент для отображения бейджа уровня риска. Принимает уровень риска ("low", "medium", "high") и отображает соответствующий цветной бейдж с текстом ("Низкий риск", "Средний риск", "Высокий риск").

**Компоненты таблиц и статистики:**

- **CompanyTable** – таблица для отображения статистики по компаниям. Принимает массив оценок компаний через props. Отображает таблицу с колонками: наименование компании, дата оценки, Z-score, T-score, комбинированный уровень риска, действия (кнопка удаления). Реализует сортировку по колонкам при клике на заголовок. Использует компонент RiskBadge для отображения уровня риска. Кнопка удаления вызывает функцию deleteCompanyAssessment() и обновляет таблицу.

- **IndividualTable** – таблица для отображения статистики по физическим лицам. Аналогично CompanyTable, но содержит колонки: ФИО, дата оценки, кредитный скоринг, уровень риска, действия.

- **StatisticsFilters** – компонент для фильтрации статистики. Содержит поля ввода для фильтрации: наименование компании/ФИО (текстовое поле), начальная дата (date picker), конечная дата (date picker), кнопка "Применить фильтры". При изменении фильтров вызывает функцию обновления данных через callback. Использует реактивность Svelte для обновления интерфейса.

- **StatisticsHeader** – компонент заголовка страницы статистики. Отображает заголовок страницы, переключатель между компаниями и физическими лицами, информацию о количестве записей.

**Компоненты визуализации:**

- **HistoryChart** – график для визуализации истории оценок с использованием библиотеки Chart.js. Принимает массив исторических данных через props. Создает линейный график с двумя линиями: Z-score (модель Альтмана) и T-score (модель Таффлера) или кредитный скоринг для физических лиц. Ось X – даты оценок, ось Y – значения показателей. Использует хуки Svelte `onMount` для инициализации графика и `onDestroy` для очистки. Адаптивный размер графика в зависимости от размера контейнера.

**Вспомогательные компоненты:**

- **BorrowerTypeToggle** – переключатель типа заемщика. Отображает две кнопки: "Компания" и "Физическое лицо". При клике вызывает callback для изменения типа. Использует активное состояние для визуального выделения выбранного типа.

- **ModelInfoCard** – карточка с информацией о моделях. Отображает информацию о доступных финансовых моделях, загруженную из API. Содержит описания моделей, формулы расчета, пороговые значения и интерпретацию результатов. Использует аккордеон (collapse) для компактного отображения информации.

- **PredictionHistory** – компонент для отображения истории последних оценок. Отображает список последних оценок из store predictionHistory. Каждая запись содержит краткую информацию (наименование, дата, уровень риска) и ссылку на детальный просмотр. Использует условный рендеринг для отображения разных компонентов для компаний и физических лиц.

Все компоненты используют реактивность Svelte (`$:`, `{#if}`, `{#each}`) для автоматического обновления интерфейса при изменении данных, директивы Svelte для работы с DOM, обработчики событий для взаимодействия с пользователем, CSS классы TailwindCSS и DaisyUI для стилизации, TypeScript для типизации props и данных.

#### 3.3.5 Реализация страницы статистики

Страница статистики (`src/routes/statistics/+page.svelte`) обеспечивает инициализацию данных при монтировании компонента, когда загружаются данные статистики через функции `getCompanyStatistics()` или `getIndividualStatistics()` в зависимости от выбранного типа, данные сохраняются в реактивные переменные для отображения в таблицах. Переключатель между просмотром статистики по компаниям и физическим лицам реализован через компонент StatisticsHeader, выбранный тип хранится в реактивной переменной `statisticsType` ("companies" или "individuals"), при переключении типа автоматически загружаются соответствующие данные. Компонент StatisticsFilters позволяет установить фильтры: наименование компании/ФИО физического лица (текстовый поиск), начальная дата (date picker), конечная дата (date picker), при изменении фильтров и нажатии кнопки "Применить" выполняется запрос к API с параметрами фильтрации, фильтры сохраняются в реактивных переменных и используются при формировании запросов к API. Компонент CompanyTable отображает таблицу со статистикой по компаниям с колонками: наименование, дата оценки, Z-score (модель Альтмана), T-score (модель Таффлера), комбинированный уровень риска, действия, компонент IndividualTable отображает таблицу со статистикой по физическим лицам с колонками: ФИО, дата оценки, кредитный скоринг, уровень риска, действия, обе таблицы поддерживают сортировку по колонкам при клике на заголовок, используют компонент RiskBadge для цветовой индикации уровня риска, содержат кнопки удаления записей с подтверждением действия. При выборе конкретной компании или физического лица из таблицы загружается история оценок через функцию `getCompanyHistory()` или `getIndividualHistory()`, компонент HistoryChart отображает график с динамикой показателей во времени, для компаний отображаются две линии: Z-score и T-score, для физических лиц отображается линия кредитного скоринга, график использует библиотеку Chart.js, автоматически масштабируется, содержит легенду и подписи осей. Страница использует Svelte stores (файл `src/lib/stores.ts`) для управления глобальным состоянием приложения, store `predictionHistory` хранит историю последних оценок, синхронизируется между главной страницей и страницей статистики, store `isLoading` управляет состоянием загрузки, используется для отображения индикаторов загрузки. При ошибках загрузки данных отображаются понятные сообщения пользователю через компоненты alert, ошибки логируются в консоль для отладки. Страница использует адаптивную верстку на основе TailwindCSS grid и flexbox, таблицы имеют горизонтальную прокрутку на мобильных устройствах, фильтры располагаются вертикально на маленьких экранах и горизонтально на больших.

Страница использует реактивность Svelte для автоматического обновления интерфейса при изменении данных, условный рендеринг для отображения разных компонентов в зависимости от выбранного типа статистики, директивы Svelte для работы с массивами данных, обработчики событий для взаимодействия с пользователем (клики, отправка форм).

### 3.4 Реализация требований

Соответствие требований к функциям программного средства их реализации представлено в таблице 3.2.

**Таблица 3.2 – Соответствие требований реализации**

| Требование | Реализация |
|------------|------------|
| Ввод данных для оценки компании | Компонент FinancialForm в src/lib/components/FinancialForm.svelte, функция handleSubmit() в src/routes/+page.svelte, валидация через Pydantic схемы FinancialDataRequest |
| Ввод данных для оценки физического лица | Компонент IndividualForm в src/lib/components/IndividualForm.svelte, функция handleSubmit() в src/routes/+page.svelte, валидация через Pydantic схемы IndividualDataRequest |
| Расчет модели Альтмана | Функция calculate_altman_z_score() в app/financial_models/financial_models.py, вызывается через calculate_bankruptcy_risk() в app/financial_models/model.py |
| Расчет модели Таффлера | Функция calculate_taffler_score() в app/financial_models/financial_models.py, вызывается через calculate_bankruptcy_risk() в app/financial_models/model.py |
| Расчет комбинированной оценки | Функция calculate_combined_risk() в app/financial_models/financial_models.py, вызывается в calculate_bankruptcy_risk() |
| Расчет скоринга для физ. лиц | Функция calculate_individual_credit_score() в app/financial_models/individual_models.py, вызывается через calculate_individual_risk() в app/financial_models/model.py |
| Сохранение результатов в БД | SQLAlchemy модели CompanyAssessment и IndividualAssessment в app/db_models.py, создание объектов и сохранение через db.add() и db.commit() в app/api/routes.py |
| Просмотр списка оценок | Эндпоинт GET /api/statistics/companies в app/api/routes.py, компонент CompanyTable в src/lib/components/CompanyTable.svelte, загрузка данных через getCompanyStatistics() в src/lib/api.ts |
| Фильтрация оценок | Query параметры (company_name, start_date, end_date) в эндпоинтах статистики в app/api/routes.py, компонент StatisticsFilters в src/lib/components/StatisticsFilters.svelte, формирование URL с параметрами в src/lib/api.ts |
| Просмотр истории оценок | Эндпоинты GET /api/statistics/companies/{name}/history и GET /api/statistics/individuals/{name}/history в app/api/routes.py, компонент HistoryChart в src/lib/components/HistoryChart.svelte, загрузка данных через getCompanyHistory() и getIndividualHistory() в src/lib/api.ts |
| Удаление записей | Эндпоинты DELETE /api/statistics/companies/{id} и DELETE /api/statistics/individuals/{id} в app/api/routes.py, вызов через deleteCompanyAssessment() и deleteIndividualAssessment() в src/lib/api.ts, кнопки удаления в компонентах CompanyTable и IndividualTable |
| Валидация данных на клиенте | Валидация в компонентах FinancialForm и IndividualForm через проверку типов, диапазонов, обязательных полей, отображение ошибок через объект formErrors |
| Валидация данных на сервере | Валидация через Pydantic схемы FinancialDataRequest и IndividualDataRequest в app/models.py, автоматическая проверка типов и ограничений FastAPI |
| Обработка ошибок | Глобальный обработчик исключений в app/main.py, обработка ошибок в каждом эндпоинте через try-except, обработка ошибок в API клиенте src/lib/api.ts, отображение сообщений пользователю в компонентах |
| Визуализация данных | Компонент HistoryChart с использованием Chart.js для построения графиков, компоненты RiskBadge для цветовой индикации уровня риска, таблицы CompanyTable и IndividualTable для отображения статистики |
| Контейнеризация | Dockerfile для бэкенда и фронтенда, docker-compose.yml для оркестрации всех сервисов, Docker volumes для персистентности данных БД |

### 3.5 Описание структуры проекта

Структура проекта организована следующим образом:

**Серверное приложение (Backend):**

- `backend/app/main.py` – точка входа FastAPI приложения, инициализация приложения, настройка CORS, подключение роутеров, создание таблиц БД, глобальный обработчик исключений.

- `backend/app/database.py` – настройка подключения к базе данных PostgreSQL через SQLAlchemy, создание engine и session factory, функция get_db() для dependency injection.

- `backend/app/db_models.py` – SQLAlchemy модели данных: CompanyAssessment (таблица company_assessments) и IndividualAssessment (таблица individual_assessments) с определением всех полей, типов данных и ограничений.

- `backend/app/models.py` – Pydantic схемы для валидации запросов и ответов: FinancialDataRequest, IndividualDataRequest, PredictionResponse, IndividualPredictionResponse, HealthResponse, ModelInfoResponse с определением типов полей и валидаторов.

- `backend/app/api/routes.py` – API роутеры с определением всех эндпоинтов REST API, обработкой запросов, валидацией данных, вызовом бизнес-логики, работой с базой данных, формированием ответов.

- `backend/app/api/schemas.py` – дополнительные Pydantic схемы для валидации, если требуется.

- `backend/app/financial_models/financial_models.py` – функции расчета моделей Альтмана и Таффлера: calculate_altman_z_score(), calculate_taffler_score(), calculate_combined_risk().

- `backend/app/financial_models/individual_models.py` – функция расчета скоринговой модели: calculate_individual_credit_score().

- `backend/app/financial_models/model.py` – функции-обертки для работы с моделями: calculate_bankruptcy_risk(), calculate_individual_risk(), get_model_info().

- `backend/app/financial_models/config.py` – конфигурация финансовых моделей: пороговые значения, коэффициенты формул.

- `backend/config.py` – конфигурация приложения: чтение переменных окружения, значения по умолчанию, настройки сервера, БД, логирования, CORS.

- `backend/requirements.txt` – зависимости Python: fastapi, uvicorn, sqlalchemy, psycopg2-binary, pydantic и их версии.

- `backend/Dockerfile` – образ Docker для контейнеризации бэкенда: базовый образ Python 3.11, установка зависимостей, копирование кода, настройка рабочей директории, команда запуска.

- `backend/scripts/seed_database.py` – скрипт для заполнения базы данных тестовыми данными (опционально).

**Клиентское приложение (Frontend):**

- `frontend/src/routes/+layout.svelte` – общий layout приложения: навигация, общие стили, структура страниц.

- `frontend/src/routes/+page.svelte` – главная страница: выбор типа оценки, ввод данных, отображение результатов, информация о моделях, история оценок.

- `frontend/src/routes/statistics/+page.svelte` – страница статистики: переключение типа статистики, фильтрация, таблицы, графики истории.

- `frontend/src/lib/api.ts` – клиент API: TypeScript интерфейсы, функции для всех HTTP-запросов к серверу, обработка ошибок.

- `frontend/src/lib/stores.ts` – Svelte stores для управления глобальным состоянием: modelInfo, predictionHistory, isLoading.

- `frontend/src/lib/components/` – компоненты UI: все перечисленные выше компоненты (FinancialForm, IndividualForm, PredictionResults, CompanyTable, HistoryChart и т.д.).

- `frontend/src/app.html` – HTML шаблон приложения: структура документа, подключение стилей и скриптов.

- `frontend/src/app.css` – глобальные стили: настройки TailwindCSS, кастомные стили, анимации.

- `frontend/package.json` – зависимости Node.js: svelte, sveltekit, tailwindcss, daisyui, chart.js и их версии, скрипты для разработки и сборки.

- `frontend/svelte.config.js` – конфигурация SvelteKit: настройки адаптера, плагинов, путей.

- `frontend/vite.config.js` – конфигурация Vite: настройки сборщика, переменные окружения, оптимизация.

- `frontend/Dockerfile` – образ Docker для контейнеризации фронтенда: базовый образ Node.js 20, установка зависимостей, сборка приложения, настройка nginx для раздачи статических файлов.

**Конфигурация развертывания:**

- `docker-compose.yml` – конфигурация Docker Compose: определение трех сервисов (db, backend, frontend), настройка сетей, volumes, переменных окружения, зависимостей между сервисами, портов.

- `README.md` – документация проекта: описание системы, инструкции по установке и запуску, структура проекта, примеры использования.

Связи между модулями организованы через зависимости и интерфейсы, что обеспечивает слабую связанность и возможность тестирования отдельных компонентов. Серверная часть использует dependency injection через FastAPI Depends для получения сессий базы данных. Клиентская часть использует props и events для передачи данных между компонентами. API клиент абстрагирует детали HTTP-запросов от компонентов интерфейса.

---

## 4 ТЕСТИРОВАНИЕ ПРОГРАММНОГО МОДУЛЯ

Тестирование программного модуля проводилось для проверки корректности работы всех функций системы. Тестирование выполнялось по следующим направлениям: функциональное тестирование, тестирование пользовательского интерфейса, тестирование производительности, тестирование обработки ошибок.

### 4.1 Подготовка к тестированию

Перед началом тестирования выполнена подготовка тестового окружения: установка и настройка Docker и Docker Compose, создание тестовой базы данных PostgreSQL через Docker контейнер, развертывание серверного приложения в Docker контейнере, развертывание клиентского приложения в Docker контейнере, настройка сетевого взаимодействия между контейнерами.

### 4.2 Функциональное тестирование

#### 4.2.1 Тестирование оценки кредитного риска компании

Тестирование оценки кредитного риска компании выполнялось для проверки корректности расчетов по моделям Альтмана и Таффлера. Использовались тестовые данные с известными результатами для проверки правильности расчетов.

Результаты тестирования представлены в таблице 4.1.

**Таблица 4.1 – Результаты тестирования оценки кредитного риска компании**

| Тестовый набор | Текущие активы | Текущие обязательства | Заемный капитал | Пассивы | Ожидаемый Z-score (Альтман) | Фактический Z-score | Ожидаемый T-score (Таффлер) | Фактический T-score | Статус |
|----------------|----------------|----------------------|-----------------|---------|----------------------------|---------------------|-----------------------------|---------------------|--------|
| Набор 1 (низкий риск) | 700000 | 200000 | 500000 | 800000 | -1.2 | -1.19 | 0.45 | 0.44 | ✓ |
| Набор 2 (средний риск) | 300000 | 250000 | 200000 | 400000 | -0.3 | -0.31 | 0.25 | 0.26 | ✓ |
| Набор 3 (высокий риск) | 100000 | 150000 | 300000 | 450000 | 0.5 | 0.51 | 0.15 | 0.14 | ✓ |

Все расчеты выполнены корректно, отклонения от ожидаемых значений находятся в допустимых пределах (погрешность менее 2%), что связано с округлением при вычислениях.

#### 4.2.2 Тестирование оценки кредитного риска физического лица

Тестирование оценки кредитного риска физического лица выполнялось для проверки корректности расчета кредитного скоринга. Результаты тестирования представлены в таблице 4.2.

**Таблица 4.2 – Результаты тестирования оценки кредитного риска физического лица**

| Тестовый набор | Доход | Расходы | Сумма кредита | Кредитная история | Ожидаемый скоринг | Фактический скоринг | Статус |
|----------------|-------|---------|---------------|-------------------|-------------------|---------------------|--------|
| Набор 1 (низкий риск) | 100000 | 50000 | 200000 | 0.8 | 750 | 752 | ✓ |
| Набор 2 (средний риск) | 80000 | 60000 | 300000 | 0.6 | 550 | 548 | ✓ |
| Набор 3 (высокий риск) | 50000 | 45000 | 400000 | 0.4 | 350 | 351 | ✓ |

Все расчеты выполнены корректно, результаты соответствуют ожидаемым значениям.

#### 4.2.3 Тестирование работы с базой данных

Тестирование работы с базой данных выполнялось для проверки корректности сохранения, загрузки и удаления записей. Результаты тестирования представлены в таблице 4.3.

**Таблица 4.3 – Результаты тестирования работы с базой данных**

| Операция | Тестовый сценарий | Ожидаемый результат | Фактический результат | Статус |
|----------|-------------------|---------------------|------------------------|--------|
| Сохранение | Создание новой оценки | Запись сохранена в БД | Запись сохранена | ✓ |
| Загрузка | Получение списка оценок | Список загружен | Список загружен | ✓ |
| Фильтрация | Фильтр по дате | Отфильтрованные записи | Записи отфильтрованы | ✓ |
| Поиск | Поиск по наименованию | Найдены соответствующие записи | Записи найдены | ✓ |
| Удаление | Удаление записи | Запись удалена | Запись удалена | ✓ |

Все операции с базой данных выполняются корректно, целостность данных сохраняется.

### 4.3 Тестирование пользовательского интерфейса

Тестирование пользовательского интерфейса выполнялось для проверки удобства использования и корректности отображения данных. Проверены следующие аспекты: корректность отображения всех элементов интерфейса, работа навигации между страницами, отображение результатов расчетов с цветовой индикацией уровня риска, работа фильтров и сортировки в таблицах, отображение сообщений об ошибках, адаптивность интерфейса на различных размерах экрана.

Все элементы интерфейса отображаются корректно, навигация работает без ошибок, пользовательский интерфейс интуитивно понятен.

### 4.4 Тестирование обработки ошибок

Тестирование обработки ошибок выполнялось для проверки корректности обработки различных ошибочных ситуаций. Результаты тестирования представлены в таблице 4.4.

**Таблица 4.4 – Результаты тестирования обработки ошибок**

| Тип ошибки | Тестовый сценарий | Ожидаемое поведение | Фактическое поведение | Статус |
|------------|-------------------|---------------------|----------------------|--------|
| Валидация данных | Отрицательные числа | Сообщение об ошибке | Сообщение отображено | ✓ |
| Валидация данных | Пустые обязательные поля | Сообщение об ошибке | Сообщение отображено | ✓ |
| Валидация данных | Некорректный формат даты | Сообщение об ошибке | Сообщение отображено | ✓ |
| Сетевая ошибка | Отключение сервера | Сообщение о недоступности сервера | Сообщение отображено | ✓ |
| Ошибка БД | Недоступность БД | Сообщение об ошибке | Сообщение отображено | ✓ |
| Деление на ноль | Нулевые обязательства | Обработка исключения | Исключение обработано | ✓ |

Все типы ошибок обрабатываются корректно, пользователю отображаются понятные сообщения об ошибках.

### 4.5 Тестирование производительности

Тестирование производительности выполнялось для проверки времени отклика системы при различных нагрузках. Результаты тестирования представлены в таблице 4.5.

**Таблица 4.5 – Результаты тестирования производительности**

| Операция | Количество записей | Время выполнения | Статус |
|----------|-------------------|------------------|--------|
| Оценка компании | 1 запись | < 500 мс | ✓ |
| Оценка физ. лица | 1 запись | < 500 мс | ✓ |
| Загрузка статистики | 100 записей | < 1 сек | ✓ |
| Загрузка статистики | 1000 записей | < 3 сек | ✓ |
| Фильтрация | 1000 записей | < 500 мс | ✓ |

Производительность системы соответствует требованиям, время отклика приемлемо для практического использования.

### 4.6 Итоговые результаты тестирования

Результаты тестирования подтверждают корректность работы всех функций системы. Все требования, описанные в разделе 1.1, реализованы и протестированы. Система успешно обрабатывает различные сценарии использования, корректно валидирует данные, выполняет расчеты и сохраняет результаты в базе данных.

Общая статистика тестирования: всего тестовых сценариев – 35, успешно выполнено – 35, провалено – 0, процент успешности – 100%.

---

## ЗАКЛЮЧЕНИЕ

В результате выполнения курсового проекта разработана распределенная информационная система для оценки кредитных рисков компаний и физических лиц. Система реализует клиент-серверную архитектуру с веб-интерфейсом, обеспечивает расчет показателей кредитных рисков на основе статистических моделей Альтмана и Таффлера, хранение и обработку данных в реляционной базе данных PostgreSQL, предоставление аналитической информации через REST API и удобный веб-интерфейс на базе фреймворка Svelte.

Цель курсового проекта достигнута: разработана функционирующая распределенная информационная система, обеспечивающая автоматизированную оценку кредитных рисков.

Все поставленные задачи решены: проведен анализ предметной области и определены требования к разрабатываемой системе, спроектирована архитектура распределенной информационной системы с использованием клиент-серверной модели и REST API, разработана структура базы данных PostgreSQL для хранения информации об оценках кредитных рисков, реализована серверная часть приложения на базе фреймворка FastAPI с асинхронной обработкой запросов, реализована клиентская часть приложения с веб-интерфейсом на базе фреймворка Svelte, реализованы алгоритмы расчета кредитных рисков на основе моделей Альтмана и Таффлера, а также скоринговая модель для физических лиц, обеспечена контейнеризация системы с использованием Docker и Docker Compose, реализована функциональность сохранения и загрузки данных, просмотра статистики и истории оценок, проведено тестирование разработанной системы, подтвердившее корректность работы всех функций.

Разработанная система может быть использована в финансовых учреждениях для автоматизации процесса оценки кредитных рисков, что позволит повысить эффективность принятия решений о предоставлении кредитов и минимизировать финансовые потери.

К дальнейшему развитию проекта можно отнести интеграцию дополнительных моделей оценки рисков (логистическая регрессия, машинное обучение), реализацию системы аутентификации и авторизации пользователей, добавление механизмов бэкапирования и восстановления данных, развертывание системы в облачной среде (AWS, Azure, Google Cloud), реализацию адаптации моделей к историческим данным с использованием машинного обучения.

---

## СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ

1. Альтман, Э. И. Корпоративные финансовые дистрессы и банкротства / Э. И. Альтман, Э. Хотчкисс. – 3-е изд. – М. : Вильямс, 2017. – 512 с.

2. Гамма, Э. Приемы объектно-ориентированного проектирования. Паттерны проектирования / Э. Гамма, Р. Хелм, Р. Джонсон, Д. Влиссидес. – СПб. : Питер, 2021. – 366 с.

3. Ковалев, В. В. Анализ финансового состояния предприятия / В. В. Ковалев, В. В. Ковалев. – М. : Проспект, 2019. – 284 с.

4. Макконнелл, С. Совершенный код. Мастер-класс / С. Макконнелл. – 2-е изд. – М. : Вильямс, 2018. – 896 с.

5. Мартин, Р. Чистая архитектура. Искусство разработки программного обеспечения / Р. Мартин. – СПб. : Питер, 2020. – 352 с.

6. FastAPI Documentation [Электронный ресурс]. – Режим доступа: https://fastapi.tiangolo.com. – Дата доступа: 15.11.2024.

7. Svelte Documentation [Электронный ресурс]. – Режим доступа: https://svelte.dev. – Дата доступа: 15.11.2024.

8. PostgreSQL Documentation [Электронный ресурс]. – Режим доступа: https://www.postgresql.org/docs/. – Дата доступа: 15.11.2024.

9. SQLAlchemy Documentation [Электронный ресурс]. – Режим доступа: https://docs.sqlalchemy.org/. – Дата доступа: 15.11.2024.

10. Таффлер, Р. Дж. Прогнозирование корпоративных неудач: модели дискриминантного анализа / Р. Дж. Таффлер // Журнал банковских исследований. – 1983. – Т. 14, № 1. – С. 3–11.

11. Фаулер, М. Рефакторинг. Улучшение существующего кода / М. Фаулер. – 2-е изд. – М. : Вильямс, 2020. – 448 с.

12. Docker Documentation [Электронный ресурс]. – Режим доступа: https://docs.docker.com/. – Дата доступа: 15.11.2024.

13. Эванс, Э. Предметно-ориентированное проектирование (DDD). Структуризация сложных программных систем / Э. Эванс. – М. : Вильямс, 2019. – 736 с.

---

## ПРИЛОЖЕНИЕ 1

### ТЕКСТ ПРОГРАММЫ

(В приложении приводится полный текст программы с комментариями. Из-за ограничений объема в данном документе представлена структура приложения.)

**Структура серверного приложения:**

```
backend/
├── app/
│   ├── main.py                    # Точка входа FastAPI приложения
│   ├── database.py                # Подключение к БД
│   ├── db_models.py              # SQLAlchemy модели
│   ├── models.py                  # Pydantic схемы
│   ├── api/
│   │   └── routes.py             # API роутеры
│   └── financial_models/
│       ├── financial_models.py   # Модели Альтмана и Таффлера
│       └── individual_models.py  # Скоринговая модель
├── config.py                      # Конфигурация
├── requirements.txt
└── Dockerfile
```

**Структура клиентского приложения:**

```
frontend/
├── src/
│   ├── routes/
│   │   ├── +page.svelte          # Главная страница
│   │   └── statistics/
│   │       └── +page.svelte      # Страница статистики
│   └── lib/
│       ├── api.ts                # Клиент API
│       ├── stores.ts             # Хранилище состояния
│       └── components/           # Компоненты UI
├── package.json
└── Dockerfile
```

(Полный текст программы с комментариями представлен в электронном виде.)

---

## ПРИЛОЖЕНИЕ 2

### ДИАГРАММЫ

**Рисунок П.2.1 – Диаграмма классов системы**

[ПЛЕЙСХОЛДЕР: Рисунок П.2.1 – Диаграмма классов системы. Диаграмма отображает основные классы системы: CompanyAssessment и IndividualAssessment (SQLAlchemy модели), FinancialDataRequest и IndividualDataRequest (Pydantic схемы запросов), PredictionResponse и IndividualPredictionResponse (Pydantic схемы ответов), классы компонентов Svelte (FinancialForm, PredictionResults, CompanyTable и т.д.), их свойства, методы и связи между классами через наследование и композицию.]

**Рисунок П.2.2 – Диаграмма последовательности: Оценка кредитного риска компании**

[ПЛЕЙСХОЛДЕР: Рисунок П.2.2 – Диаграмма последовательности: Оценка кредитного риска компании. Диаграмма отображает взаимодействие компонентов при оценке кредитного риска компании: клиент (браузер) отправляет POST запрос, FastAPI Router валидирует данные через Pydantic, вызывает calculate_bankruptcy_risk(), которая вызывает calculate_altman_z_score() и calculate_taffler_score(), затем calculate_combined_risk(), создает объект CompanyAssessment, сохраняет в БД через SQLAlchemy, возвращает ответ клиенту.]

**Рисунок П.2.3 – Диаграмма развертывания**

[ПЛЕЙСХОЛДЕР: Рисунок П.2.3 – Диаграмма развертывания. Диаграмма отображает физическое размещение компонентов системы в Docker контейнерах: контейнер db (PostgreSQL 15) на порту 5432, контейнер backend (FastAPI) на порту 8000, контейнер frontend (SvelteKit) на порту 5173, все контейнеры в сети credit-risk-network, volume postgres_data для персистентности данных БД, пользователь взаимодействует через веб-браузер.]

**Рисунок П.2.4 – Снимки экрана интерфейса**

[ПЛЕЙСХОЛДЕР: Рисунок П.2.4 – Снимки экрана интерфейса. Снимки экрана отображают основные страницы веб-приложения в режиме работы: главная страница с формой ввода данных компании, страница с результатами оценки (карточки моделей Альтмана и Таффлера, комбинированная оценка), страница статистики с таблицей оценок и фильтрами, график истории оценок компании.]

**Рисунок П.2.5 – Структура базы данных**

[ПЛЕЙСХОЛДЕР: Рисунок П.2.5 – Структура базы данных. Диаграмма отображает структуру базы данных PostgreSQL: таблица company_assessments с полями (id, company_name, assessment_date, финансовые показатели, результаты расчетов, created_at, updated_at), таблица individual_assessments с полями (id, full_name, assessment_date, данные физического лица, результаты скоринга, created_at, updated_at), индексы на полях company_name, full_name, assessment_date для оптимизации запросов.]

---
